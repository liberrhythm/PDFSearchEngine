Learning with Group Invariant Features:
A Kernel Perspective.

Youssef Mroueh
IBM Watson Group
mroueh@us.ibm.com

Stephen Voinea‚àó
CBMM, MIT.
voinea@mit.edu
‚àóCo-first author

Tomaso Poggio
CBMM, MIT .
tp@ai.mit.edu

Abstract
We analyze in this paper a random feature map based on a theory of invariance
(I-theory) introduced in [1]. More specifically, a group invariant signal signature
is obtained through cumulative distributions of group-transformed random projections. Our analysis bridges invariant feature learning with kernel methods, as
we show that this feature map defines an expected Haar-integration kernel that is
invariant to the specified group action. We show how this non-linear random feature map approximates this group invariant kernel uniformly on a set of N points.
Moreover, we show that it defines a function space that is dense in the equivalent
Invariant Reproducing Kernel Hilbert Space. Finally, we quantify error rates of
the convergence of the empirical risk minimization, as well as the reduction in the
sample complexity of a learning algorithm using such an invariant representation
for signal classification, in a classical supervised learning setting.

1

Introduction

Encoding signals or building similarity kernels that are invariant to the action of a group is a key
problem in unsupervised learning, as it reduces the complexity of the learning task and mimics how
our brain represents information invariantly to symmetries and various nuisance factors (change in
lighting in image classification and pitch variation in speech recognition) [1, 2, 3, 4]. Convolutional
neural networks [5, 6] achieve state of the art performance in many computer vision and speech
recognition tasks, but require a large amount of labeled examples as well as augmented data, where
we reflect symmetries of the world through virtual examples [7, 8] obtained by applying identitypreserving transformations such as shearing, rotation, translation, etc., to the training data. In this
work, we adopt the approach of [1], where the representation of the signal is designed to reflect
the invariant properties and model the world symmetries with group actions. The ultimate aim is
to bridge unsupervised learning of invariant representations with invariant kernel methods, where
we can use tools from classical supervised learning to easily address the statistical consistency and
sample complexity questions [9, 10]. Indeed, many invariant kernel methods and related invariant
kernel networks have been proposed. We refer the reader to the related work section for a review
(Section 5) and we start by showing how to accomplish this invariance through group-invariant Haarintegration kernels [11], and then show how random features derived from a memory-based theory
of invariances introduced in [1] approximate such a kernel.
1.1

Group Invariant Kernels

We start by reviewing group-invariant Haar-integration kernels introduced in [11], and their use in a
binary classification problem. This section highlights the conceptual advantages of such kernels as
well as their practical inconvenience, putting into perspective the advantage of approximating them
with explicit and invariant random feature maps.
1

Invariant Haar-Integration Kernels. We consider a subset X of the hypersphere in d dimensions
Sd‚àí1 . Let œÅX be a measure on X . Consider a kernel k0 on X , such as a radial basis function kernel.
Let G be a group acting on X , with a normalized Haar measure ¬µ. G is assumed to be a compact
and unitary group. Define an invariant kernel K between x, z ‚àà X through Haar-integration [11] as
follows:
Z Z
K(x, z) =
k0 (gx, g 0 z)d¬µ(g)d¬µ(g 0 ).
(1)
G

G

As we are integrating over the entire group, it is easy to see that: K(g 0 x, gz) = K(x, z), ‚àÄg, g 0 ‚àà
G, ‚àÄx, z ‚àà X . Hence the Haar-integration kernel is invariant to the group action. The symmetry of
K is obvious. Moreover, if k0 is a positive definite kernel, it follows that K is positive definite as
well [11]. One can see the Haar-integration kernel framework as another form of data augmentation,
since we have to produce group-transformed points in order to compute the kernel.
Invariant Decision Boundary. Turning now to a binary classification problem, we assume that we
are given a labeled training set: S = {(xi , yi ) | xi ‚àà X , yi ‚àà Y = {¬±1}}N
i=1 . In order to learn a
decision function f : X ‚Üí Y, we minimize the following empirical risk induced by an L-Lipschitz,
PN
convex loss function V , with V 0 (0) < 0 [12]: minf ‚ààHK EÃÇV (f ) := N1 i=1 V (yi f (xi )), where we
restrict f to belong to a hypothesis class induced by the invariant kernel K, the so called Reproducing
Kernel Hilbert Space HK . The representer theorem [13] shows that the solution of such a problem,
PN
‚àó
‚àó
(x) = i=1 Œ±i‚àó K(x, xi ). Since the
has the following form: fN
or the optimal decision boundary fN
PN
PN
‚àó
(gx) = i=1 Œ±i K(gx, xi ) = i=1 Œ±i K(x, xi ) =
kernel K is group-invariant it follows that : fN
‚àó
‚àó
fN (x), ‚àÄg ‚àà G. Hence the the decision boundary f is group-invariant as well, and we have:
‚àó
‚àó
fN
(gx) = fN
(x), ‚àÄg ‚àà G, ‚àÄx ‚àà X .
Reduced Sample Complexity. We have shown that a group-invariant kernel induces a groupinvariant decision boundary, but how does this translate to the sample complexity of the learning
algorithm? To answer this question, we will assume that the input set X has the following structure:
X = X0 ‚à™ GX0 , GX0 = {z|z = gx, x ‚àà X0 , g ‚àà G/ {e}}, where e is the identity group element.
This structure implies that for a function f in the invariant RKHS HK , we have:
‚àÄz ‚àà GX0 , ‚àÉ x ‚àà X0 , ‚àÉ g ‚àà G such that, z = gx, and f (z) = f (x).
Let œÅy (x) = P(Y = y|x) be the label posteriors. We assume that œÅy (gx) = œÅy (x), ‚àÄg ‚àà G. This
is a natural assumption since the label is unchanged given the group action. Assume that the set X
is endowed with a measure œÅX that is also group-invariant. Let f be the group-invariant decision
function and consider the expected risk induced by the loss V , EV (f ), defined as follows:
Z X
EV (f ) =
V (yf (x))œÅy (x)œÅX (x)dx,
(2)
X y‚ààY

EV (f ) is a proxy to the misclassification risk [12]. Using the invariant properties of the function
class and the data distribution we have by invariance of f , œÅy , and œÅ:
Z X
Z
X
EV (f ) =
V (yf (x))œÅy (x)œÅX (x)dx +
V (yf (z))œÅy (z)œÅX (z)dz
X0 y‚ààY

GX0 y‚ààY

Z
=

Z
d¬µ(g)

Z

Z
d¬µ(g)

Z

X

V (yf (x))œÅy (x)œÅX (x)dx (By invariance of f , œÅy , and œÅ )

X0 y‚ààY

G

=

V (yf (gx))œÅy (gx)œÅX (x)dx

X0 y‚ààY

G

=

X

X

V (yf (x))œÅy (x)œÅX (x)dx.

X0 y‚ààY

Hence, given an invariant kernel to a group action that is identity preserving, it is sufficient to
minimize the empirical risk on the core set X0 , and it generalizes to samples in GX0 .
Let us imagine that X is finite with cardinality |X |; the cardinality of the core set X0 is a small
fraction of the cardinality of X : |X0 | = Œ±|X |, where 0 < Œ± < 1. Hence, when we sample training
points from X0 , the maximum size of the training set is N = Œ±|X | << |X |, yielding a reduction in
the sample complexity.
2

1.2

Contributions

We have just reviewed the group-invariant Haar-integration kernel. In summary, a group-invariant
kernel implies the existence of a decision function that is invariant to the group action, as well as
a reduction in the sample complexity due to sampling training points from a reduced set, a.k.a the
core set X0 .
Kernel methods with Haar-integration kernels come at a very expensive computational price at both
training and test time: computing the Kernel is computationally cumbersome as we have to integrate
over the group and produce virtual examples by transforming points explicitly through the group
action. Moreover, the training complexity of kernel methods scales cubicly in the sample size.
Those practical considerations make the usefulness of such kernels very limited.
The contributions of this paper are on three folds:
1. We first show that a non-linear random feature map Œ¶ : X ‚Üí RD derived from a memorybased theory of invariances introduced in [1] induces an expected group-invariant Haarintegration kernel K. For fixed points x, z ‚àà X , we have: E hŒ¶(x), Œ¶(z)i = K(x, z),
where K satisfies: K(gx, g 0 z) = K(x, z), ‚àÄg, g 0 ‚àà G, x, z ‚àà X .
2. We show a Johnson-Lindenstrauss type result that holds uniformly on a set of N points that
assess the concentration of this random feature map around its expected induced kernel. For
sufficiently large D, we have hŒ¶(x), Œ¶(z)i ‚âà K(x, z), uniformly on an N points set.
3. We show that, with a linear model, an invariant decision function can be learned in this
‚àó
random feature space by sampling points from the core set X0 i.e: fN
(x) ‚âà hw‚àó , Œ¶(x)i
and generalizes to unseen points in GX0 , reducing the sample complexity. Moreover, we
show that those features define a function space that approximates a dense subset of the
invariant RKHS, and assess the error rates of the empirical risk minimization using such
random features.
4. We demonstrate the validity of these claims on three datasets: text (artificial), vision
(MNIST), and speech (TIDIGITS).

2

From Group Invariant Kernels to Feature Maps

In this paper we show that a random feature map based on I-theory [1]: Œ¶ : X ‚Üí RD approximates
a group-invariant Haar-integration kernel K having the form given in Equation (1):
hŒ¶(x), Œ¶(z)i ‚âà K(x, z).
We start with some notation that will be useful for defining the feature map. Denote the cumulative
distribution function of a random variable X by,
FX (œÑ ) = P(X ‚â§ œÑ ),
Fix x ‚àà X , Let g ‚àà G be a random variable drawn according to the normalized Haar measure ¬µ and
let t be a random template whose distribution will be defined later. For s > 0, define the following
truncated cumulative distribution function (CDF) of the dot product hx, gti:
œà(x, t, œÑ ) = Pg (hx, gti ‚â§ œÑ ) = Fhx,gti (œÑ ), œÑ ‚àà [‚àís, s], x ‚àà X ,
Let Œµ ‚àà (0, 1). We consider the following Gaussian vectors (sampling with rejection) for the templates t:


1
2
t = n ‚àº N 0, Id , if knk2 < 1 + Œµ, t =‚ä• else .
d
The reason behind this sampling is to keep the range of hx, gti under control: The squared norm
2
knk2 will be bounded by 1 + Œµ with high probability by a classical concentration result (See proof
d‚àí1
of Theorem
‚àö 1 for more details). The group being unitary and x ‚àà S , we know that : | hx, gti | ‚â§
knk2 < 1 + Œµ ‚â§ 1 + Œµ, for Œµ ‚àà (0, 1).
Remark 1. We can also consider templates t, drawn uniformly on the unit sphere Sd‚àí1 . Uniform
templates on the sphere can be drawn as follows:
ŒΩ
t=
, ŒΩ ‚àº N (0, Id ),
kŒΩk2
3

‚àö
since the norm of a gaussian vector is highly concentrated around its mean d, we can use the
gaussian sampling with rejection. Results proved for gaussian templates (with rejection) will hold
true for templates drawn at uniform on the sphere with different constants.
Define the following kernel function,
Z
Ks (x, z)

s

= Et

œà(x, t, œÑ )œà(z, t, œÑ )dœÑ,
‚àís

where s will be fixed throughout the paper to be s = 1+Œµ since the gaussian sampling with rejection
controls the dot product to be in that range.
R
Let
œà(t, gÃÑx, œÑ ) = G 1IhggÃÑx,ti‚â§œÑ d¬µ(g) =
R gÃÑ ‚àà G. As the group is closed, we have
1I
d¬µ(g) = œà(t, x, œÑ ) and hence K(gx, g 0 z) = K(x, z), for all g, g 0 ‚àà G. It is clear
G hgx,ti‚â§œÑ
now that K is a group-invariant kernel.
In order to approximate K, we sample |G| elements uniformly and independently from the group
G, i.e. gi , i = 1 . . . |G|, and define the normalized empirical CDF :
|G|

œÜ(x, t, œÑ ) =

X
1
‚àö
1Ihgi t,xi‚â§œÑ , ‚àí s ‚â§ œÑ ‚â§ s.
|G| m i=1

We discretize the continuous threshold œÑ as follows:


‚àö
|G|
sk
s X
œÜ x, t,
=‚àö
1Ihgi t,xi‚â§ ns k , ‚àí n ‚â§ k ‚â§ n.
n
nm|G| i=1
We sample m templates independently according to the Gaussian sampling with rejection, tj , j =
1 . . . m. We are now ready to define the random feature map Œ¶:

 
sk
‚àà R(2n+1)√óm .
Œ¶(x) = œÜ x, tj ,
n
j=1...m,k=‚àín...n
It is easy to see that:
lim Et,g hŒ¶(x), Œ¶(z)iR(2n+1)√óm = lim Et,g

n‚Üí‚àû

n‚Üí‚àû

m X
n
X
j=1 k=‚àín

 


sk
sk
œÜ x, tj ,
œÜ z, tj ,
= Ks (x, z).
n
n

In Section 3 we study the geometric information captured by this kernel by stating explicitly the
similarity it computes.
Remark 2 (Efficiency of the representation). 1) The main advantage of such a feature map, as
outlined in [1], is that we store transformed templates in order to compute Œ¶, while if we wanted
to compute an invariant kernel of type K (Equation (1)), we would need to explicitly transform
the points. The latter is computationally expensive. Storing transformed templates and computing
the signature Œ¶ is much more efficient. It falls in the category of memory-based learning, and is
biologically plausible [1].
2) As |G|,m,n get large enough, the feature map Œ¶ approximates a group-invariant Kernel, as we
will see in next section.

3

An Equivalent Expected Kernel and a Uniform Concentration Result

In this section we present our main results, with proofs given in the supplementary material . Theorem 1 shows that the random feature map Œ¶, defined in the previous section, corresponds in expectation to a group-invariant Haar-integration kernel Ks (x, z). Moreover, s ‚àí Ks (x, z) computes the
average pairwise distance between all points in the orbits of x and z, where the orbit is defined as
the collection of all group-transformations of a given point x : Ox = {gx, g ‚àà G}.
Theorem 1 (Expectation). Let Œµ ‚àà (0, 1) and x, z ‚àà X . Define the distance dG between the orbits
Ox and Oz :
Z Z
1
dG (x, z) = ‚àö
kgx ‚àí g 0 zk2 d¬µ(g)d¬µ(g 0 ),
2œÄd G G
and the group-invariant expected kernel
Z s
Ks (x, z) = lim Et,g hŒ¶(x), Œ¶(z)iR(2n+1)√óm = Et
œà(x, t, œÑ )œà(z, t, œÑ )dœÑ, s = 1 + Œµ.
n‚Üí‚àû

‚àís

4

1. The following inequality holds with probability 1:
Œµ ‚àí Œ¥2 (d, Œµ) ‚â§ Ks (x, z) ‚àí (1 ‚àí dG (x, z)) ‚â§ Œµ + Œ¥1 (d, Œµ),
where Œ¥1 (Œµ, d) =

‚àídŒµ2 /16

e ‚àö

d

‚àí

1e
2

‚àíŒµd/2

d
(1+Œµ) 2

‚àö

d

and Œ¥2 (Œµ, Œ¥) =

‚àídŒµ2 /16

e ‚àö

d

(3)
2

+ (1 + Œµ)e‚àídŒµ

/8

.

2. For any Œµ ‚àà (0, 1) as the dimension d ‚Üí ‚àû we have Œ¥1 (Œµ, d) ‚Üí 0 and Œ¥2 (Œµ, d) ‚Üí 0, and
we have asymptotically Ks (x, z) ‚Üí 1 ‚àí dG (x, z) + Œµ = s ‚àí dG (x, z).
3. Ks is symmetric and Ks is positive semi-definite.
Remark 3. 1) Œµ, Œ¥1 (d, Œµ), and Œ¥2 (d, Œµ) are not errors due to results holding with high probability
but are due to the truncation and are a technical artifact of the proof. 2) Local invariance can be
defined by restricting the sampling of the group elements to a subset G ‚äÇ G. Assuming that for each
g ‚àà G, g ‚àí1 ‚àà G, the equivalent kernel has asymptotically the following form:
Z Z
1
Ks (x, z) ‚âà s ‚àí ‚àö
kgx ‚àí g 0 zk2 d¬µ(g)d¬µ(g 0 ).
2œÄd G G
3) The norm-one constraint can be relaxed, let R = supx‚ààX kxk2 < ‚àû, hence we can set s =
R(1 + Œµ), and
‚àíŒ¥2 (d, Œµ) ‚â§ Ks (x, z) ‚àí (R(1 + Œµ) ‚àí dG (x, z)) ‚â§ Œ¥1 (d, Œµ),
where Œ¥1 (Œµ, d) = R e

‚àídŒµ2 /16

‚àö

d

‚àí

Re
2

‚àíŒµd/2

d
(1+Œµ) 2

‚àö

d

and Œ¥2 (Œµ, Œ¥) = R e

‚àídŒµ2 /16

‚àö

d

(4)
2

+ R(1 + Œµ)e‚àídŒµ

/8

.

Theorem 2 is, in a sense, an invariant Johnson-Lindenstrauss [14] type result where we show that
the dot product defined by the random feature map Œ¶ , i.e hŒ¶(x), Œ¶(z)i, is concentrated around the
invariant expected kernel uniformly on a data set of N points, given a sufficiently large number of
templates m, a large number of sampled group elements |G|, and a large bin number n. The error
naturally decomposes to a numerical error Œµ0 and statistical errors Œµ1 , Œµ2 due to the sampling of the
templates and the group elements respectively.
Theorem 2. [Johnson-Lindenstrauss type Theorem- N point Set] Let D = {xi | xi ‚àà X }N
i=1
be a finite dataset. Fix Œµ0 , Œµ1 , Œµ2 , Œ¥1 , Œ¥2 ‚àà (0, 1). For a number of bins n ‚â• Œµ10 , templates m ‚â•
C1
log( Œ¥N1 ), and group elements |G| ‚â• CŒµ22 log( NŒ¥2m ), where C1 , C2 are universal numeric constants,
Œµ21
2
we have:
|hŒ¶(xi ), Œ¶(xj )i ‚àí Ks (xi , xj )| ‚â§ Œµ0 + Œµ1 + Œµ2 , i = 1 . . . N, j = 1 . . . N,

(5)

with probability 1 ‚àí Œ¥1 ‚àí Œ¥2 .
Putting together Theorems 1 and 2, the following Corollary shows how the group-invariant random
feature map Œ¶ captures the invariant distance between points uniformly on a dataset of N points.
Corollary 1 (Invariant Features Maps and Distances between Orbits). Let D = {xi | xi ‚àà X }N
i=1
N
1
be a finite dataset. Fix Œµ0 , Œ¥ ‚àà (0, 1). For a number of bins n ‚â• Œµ30 , templates m ‚â• 9C
log(
2
Œ¥ ),
Œµ
and group elements |G| ‚â•

9C2
Œµ20

0

log( NŒ¥m ), where C1 , C2 are universal numeric constants, we have:

Œµ ‚àí Œ¥2 (d, Œµ) ‚àí Œµ0 ‚â§ hŒ¶(xi ), Œ¶(xj )i ‚àí (1 ‚àí dG (xi , xj )) ‚â§ Œµ0 + Œµ + Œ¥1 (d, Œµ),

(6)

i = 1 . . . N, j = 1 . . . N , with probability 1 ‚àí 2Œ¥.
Remark 4. Assuming that the templates are unitary and drawn form a general distribution p(t), the
equivalent kernel has the following form:
Z

Z Z
0
0
Ks (x, z) =
d¬µ(g)d¬µ(g )
s ‚àí max(hx, gti , hz, g ti)p(t)dt .
G

G

Indeed when we use the gaussian sampling with rejection for the templates,
the integral

R
0
 ‚àí1
,‚àí1 
0
max(hx, gti , hz, g ti)p(t)dt is asymptotically proportional to g x ‚àí g
z  . It is interesting
2
to consider different distributions that are domain-specific for the templates and assess the number
of the templates needed to approximate such kernels. It is also interesting to find the optimal templates that achieve the minimum distortion in equation 6, in a data dependent way, but we will
address these points in future work.
5

4

Learning with Group Invariant Random Features

In this section, we show that learning a linear model in the invariant, random feature space, on a
training set sampled from the reduced core set X0 , has a low expected risk, and generalizes to unseen
test points generated from the distribution on X = X0 ‚à™ GX0 . The architecture of the proof follows
ideas from [15] and [16]. Recall that given an L-Lipschitz convex loss function V , our aim is to
minimize the expected risk given in Equation (2). Denote the CDF by œà(x, t, œÑ ) = P(hgt, xi ‚â§ œÑ ),
P|G|
1
and the empirical CDF by œàÃÇ(x, t, œÑ ) = |G|
i=1 1Ihgi t,xi‚â§œÑ . Let p(t) be the distribution of templates
R Rs
t. The RKHS defined by the invariant kernel Ks , Ks (x, z) =
œà(x, t, œÑ )œà(z, t, œÑ )p(t)dtdœÑ
‚àís
denoted HKs , is the completion of the set of all finite linear combinations of the form:
X
f (x) =
Œ±i Ks (x, xi ), xi ‚àà X , Œ±i ‚àà R.
(7)
i

Similarly to [16], we define the following infinite-dimensional function space:


Z Z s
|w(t, œÑ )|
Fp = f (x) =
w(t, œÑ )œà(x, t, œÑ )dtdœÑ | sup
‚â§C .
p(t)
œÑ,t
‚àís
R P
Lemma 1. Fp is dense in HKs . For f ‚àà Fp we have EV (f ) = X0 y‚ààY V (yf (x))œÅy (x)dœÅX (x),
where X0 is the reduced core set.
Since Fp is dense in HKs , we canh learn an invariant
decision function in the space Fp , instead
i
sk
of learning in HKs . Let Œ®(x) = œàÃÇ x, tj , n
. Œ®, and Œ¶ are equivalent up to
j=1...m,k=‚àín...n

constants. We will approximate the set Fp as follows:
Ô£±
Ô£º


m X
n
Ô£≤
X
s
CÔ£Ω
sk
FÃÉ = f (x) = hw, Œ®(x)i =
wj,k œàÃÇ x, tj ,
, tj ‚àº p, j = 1 . . . m | kwk‚àû ‚â§
.
Ô£≥
n j=1
n
mÔ£æ
k=‚àín

Hence, we learn the invariant decision function via empirical risk minimization where we restrict
the function to belong to FÃÉ, and the sampling in the training set is restricted to the core set X0 . Note
that with this function space we are regularizing for convenience the norm infinity of the weights
but this can be relaxed in practice to a classical Tikhonov regularization.
Theorem 3 (Learning with Group invariant features). Let S = {(xi , yi ) | xi ‚àà X0 , yi ‚àà
‚àó
Y, i = 1 . . . N }, a training set sampled from the core set X0 . Let fN
= arg minf ‚ààFÃÉ EÃÇV (f ) =
PN
1
i=1 V (yi f (xi )).Fix Œ¥ > 0, then
N
s
 !
1
1
1
‚àó
log
4LsC + 2V (0) + LC
EV (fN ) ‚â§ min EV (f ) + 2 ‚àö
f ‚ààFp
2
Œ¥
N
s
!
r
 !

 m  2sC
1
2sC
2sLC
1 + 2 log
+L p
1 + 2 log
+
,
+ ‚àö
Œ¥
Œ¥
n
m
|G|
with probability at least 1 ‚àí 3Œ¥ on the training set and the choice of templates and group elements.
The proof of Theorem 3 is given in Appendix B. Theorem 3 shows that learning a linear model
in the invariant random feature space defined by Œ¶ (or equivalently Œ®), has a low expected
risk. More importantly, this risk is arbitrarily close to the optimal risk achieved in an infinitedimensional class of functions, namely Fp . The training set is sampled from the reduced core
set X0 , and invariant learning generalizes to unseen test points generated from the distribution
on X = X0 ‚à™ GX0 , hence the reduction in the sample complexity. Recall that Fp is dense in
the RKHS of the Haar-integration invariant Kernel, and so the expected risk achieved by a linear
model in the invariant random feature space is not far from the one attainable in the invariant
RKHS. Note that the error decomposes into two terms. The first, O( ‚àö1N ), is statistical and it
depends on the training sample complexity N . The other is governed by the approximation error of
functions Fp , with functions in FÃÉ, and depends on the number of templates m, number
q of group

elements sampled |G|, the number of bins n, and has the following form O( ‚àö1m )+O

6

log m
|G|

+ n1 .

5

Relation to Previous Work

We now put our contributions in perspective by outlining some of the previous work on invariant
kernels and approximating kernels with random features.
Approximating Kernels. Several schemes have been proposed for approximating a non-linear kernel with an explicit non-linear feature map in conjunction with linear methods, such as the NystroÃàm
method [17] or random sampling techniques in the Fourier domain for translation-invariant kernels
[15]. Our features fall under the random sampling techniques where, unlike previous work, we sample both projections and group elements to induce invariance with an integral representation. We
note that the relation between random features and quadrature rules has been thoroughly studied in
[18], where sharper bounds and error rates are derived, and can apply to our setting.
Invariant Kernels. We focused in this paper on Haar-integration kernels [11], since they have an
integral representation and hence can be represented with random features [18]. Other invariant
kernels have been proposed: In [19] authors introduce transformation invariant kernels, but unlike
our general setting, the analysis is concerned with dilation invariance. In [20], multilayer arccosine
kernels are built by composing kernels that have an integral representation, but does not explicitly
induce invariance. More closely related to our work is [21], where kernel descriptors are built for visual recognition by introducing a kernel view of histogram of gradients that corresponds in our case
to the cumulative distribution on the group variable. Explicit feature maps are obtained via kernel
PCA, while our features are obtained via random sampling. Finally the convolutional kernel network
of [22] builds a sequence of multilayer kernels that have an integral representation, by convolution,
considering spatial neighborhoods in an image. Our future work will consider the composition of
Haar-integration kernels, where the convolution is applied not only to the spatial variable but to the
group variable akin to [2].

6

Numerical Evaluation

In this paper, and specifically in Theorems 2 and 3, we showed that the random, group-invariant
feature map Œ¶ captures the invariant distance between points, and that learning a linear model
trained in the invariant, random feature space will generalize well to unseen test points. In this
section, we validate these claims through three experiments. For the claims of Theorem 2, we
will use a nearest neighbor classifier, while for Theorem 3, we will rely on the regularized least
squares (RLS) classifier, one of the simplest algorithms for supervised learning. While our proofs
focus on norm-infinity regularization, RLS corresponds to Tikhonov regularization with square
loss. Specifically, for performing T ‚àíway classification on a batch of N training points in Rd ,
N √ód
summarized in the data matrix
and label matrix	 Y ‚àà RN √óT , RLS will perform the
1 X ‚àà R
optimization, minW ‚ààRm√óT N ||Y ‚àí Œ¶(X)W ||2F + Œª||W ||2F , where || ¬∑ ||F is the Frobenius norm,
Œª is the regularization parameter, and Œ¶ is the feature map, which for the representation described
in this paper will be a CDF pooling of the data projected onto group-transformed random templates.
All RLS experiments in this paper were completed with the GURLS toolbox [23]. The three
datasets we explore are:
Xperm (Figure 1): An artificial dataset consisting of all sequences of length 5 whose elements
come from an alphabet of 8 characters. We want to learn a function which assigns a positive value
to any sequence that contains a target set of characters (in our case, two of them) regardless of their
position. Thus, the function label is globally invariant to permutation, and so we project our data
onto all permuted versions of our random template sequences.
MNIST (Figure 2): We seek local invariance to translation and rotation, and so all random templates
are translated by up to 3 pixels in all directions and rotated between -20 and 20 degrees.
TIDIGITS (Figure 3): We use a subset of TIDIGITS consisting of 326 speakers (men, women,
children) reading the digits 0-9 in isolation, and so each datapoint is a waveform of a single word.
We seek local invariance to pitch and speaking rate [25], and so all random templates are pitch
shifted up and down by 400 cents and warped to play at half and double speed. The task is 10-way
classification with one class-per-digit. See [24] for more detail.
Acknowledgements: Stephen Voinea acknowledges the support of a Nuance Foundation Grant.
This work was also supported in part by the Center for Brains, Minds and Machines (CBMM),
funded by NSF STC award CCF 1231216.
7

Xperm Sample Complexity RLS
Œ¶
1.0

Raw
Bag‚àíOf‚àíWords

Haar
CDF(25,1)

Xperm Sample Complexity 1 ‚àí NN

CDF(25,10)
CDF(25,25)

Raw
Bag‚àíOf‚àíWords

Œ¶

CDF(25,1)

0.9

Accuracy

0.8

0.7

0.6

0.5

0.4

10

100

1000

10

Number of Training Points Per Class

100

1000

Number of Training Points Per Class

Figure 1: Classification accuracy as a function of training set size, averaged over 100 random
training samples at each size. Œ¶ = CDF(n, m) refers to a random feature map with n bins and m
templates. With 25 templates, the random feature map outperforms the raw features and a bag-ofwords representation (also invariant to permutation) and even approaches an RLS classifier with a
Haar-integration kernel. Error bars were removed from the RLS plot for clarity. See supplement.
MNIST Accuracy RLS (1000 Points Per Class)
Bins
1.0

5

MNIST Sample Complexity RLS

25

Œ¶

1.0

Raw

CDF(50,500)

0.9
0.9

0.8

Accuracy

0.7
0.8
0.6
0.5
0.7
0.4
0.3

0.6

0.2
0.1

1

10

0.5

100

10

Number of Templates

100

1000

Number of Training Points Per Class

Figure 2: Left Plot) Mean classification accuracy as a function of number of bins and templates,
averaged over 30 random sets of templates. Right Plot) Classification accuracy as a function of
training set size, averaged over 100 random samples of the training set at each size. At 1000 examples per class, we achieve an accuracy of 98.97%.
TIDIGITS Gender RLS

TIDIGITS Speaker RLS
Bins 5 25 100

1.0

Bins

5

25

100

0.9
0.8

Accuracy

0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.0

10

100

1000

10

Number of Templates

100

1000

Number of Templates

Figure 3: Mean classification accuracy as a function of number of bins and templates, averaged
over 30 random sets of templates. In the ‚ÄúSpeaker‚Äù dataset, we test on unseen speakers, and in the
‚ÄúGender‚Äù dataset, we test on a new gender, giving us an extreme train/test mismatch. [25].

8

References
[1] F. Anselmi, J. Z. Leibo, L. Rosasco, J. Mutch, A. Tacchetti, and T. Poggio, ‚ÄúUnsupervised
learning of invariant representations in hierarchical architectures.,‚Äù CoRR, vol. abs/1311.4158,
2013.
[2] J. Bruna and S. Mallat, ‚ÄúInvariant scattering convolution networks,‚Äù CoRR, vol. abs/1203.1513,
2012.
[3] G. Hinton, A. Krizhevsky, and S. Wang, ‚ÄúTransforming auto encoders,‚Äù ICANN-11, 2011.
[4] Y. Bengio, A. C. Courville, and P. Vincent, ‚ÄúRepresentation learning: A review and new perspectives,‚Äù IEEE Trans. Pattern Anal. Mach. Intell., vol. 35, no. 8, pp. 1798‚Äì1828, 2013.
[5] Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, ‚ÄúGradient-based learning applied to document
recognition,‚Äù in Proceedings of the IEEE, vol. 86, pp. 2278‚Äì2324, 1998.
[6] A. Krizhevsky, I. Sutskever, and G. E. Hinton, ‚ÄúImagenet classification with deep convolutional
neural networks.,‚Äù in NIPS, pp. 1106‚Äì1114, 2012.
[7] P. Niyogi, F. Girosi, and T. Poggio, ‚ÄúIncorporating prior information in machine learning by
creating virtual examples,‚Äù in Proceedings of the IEEE, pp. 2196‚Äì2209, 1998.
[8] Y.-A. Mostafa, ‚ÄúLearning from hints in neural networks,‚Äù Journal of complexity, vol. 6,
pp. 192‚Äì198, June 1990.
[9] V. N. Vapnik, Statistical learning theory. A Wiley-Interscience Publication 1998.
[10] I. Steinwart and A. Christmann, Support vector machines. Information Science and Statistics,
New York: Springer, 2008.
[11] B. Haasdonk, A. Vossen, and H. Burkhardt, ‚ÄúInvariance in kernel methods by haar-integration
kernels.,‚Äù in SCIA , Springer, 2005.
[12] P. L. Bartlett, M. I. Jordan, and J. D. McAuliffe, ‚ÄúConvexity, classification, and risk bounds,‚Äù
Journal of the American Statistical Association, vol. 101, no. 473, pp. 138‚Äì156, 2006.
[13] G. Wahba, Spline models for observational data, vol. 59 of CBMS-NSF Regional Conference
Series in Applied Mathematics. Philadelphia, PA: SIAM, 1990.
[14] W. B. Johnson and J. Lindenstrauss, ‚ÄúExtensions of lipschitz mappings into a hilbert space.,‚Äù
Conference in modern analysis and probability, 1984.
[15] A. Rahimi and B. Recht, ‚ÄúWeighted sums of random kitchen sinks: Replacing minimization
with randomization in learning.,‚Äù in NIPS 2008.
[16] A. Rahimi and B. Recht, ‚ÄúUniform approximation of functions with random bases,‚Äù in Proceedings of the 46th Annual Allerton Conference, 2008.
[17] C. Williams and M. Seeger, ‚ÄúUsing the nystrm method to speed up kernel machines,‚Äù in NIPS,
2001.
[18] F. R. Bach, ‚ÄúOn the equivalence between quadrature rules and random features,‚Äù CoRR,
vol. abs/1502.06800, 2015.
[19] C. Walder and O. Chapelle, ‚ÄúLearning with transformation invariant kernels,‚Äù in NIPS, 2007.
[20] Y. Cho and L. K. Saul, ‚ÄúKernel methods for deep learning,‚Äù in NIPS, pp. 342‚Äì350, 2009.
[21] L. Bo, X. Ren, and D. Fox, ‚ÄúKernel descriptors for visual recognition,‚Äù in NIPS., 2010.
[22] J. Mairal, P. Koniusz, Z. Harchaoui, and C. Schmid, ‚ÄúConvolutional kernel networks,‚Äù in NIPS,
2014.
[23] A. Tacchetti, P. K. Mallapragada, M. Santoro, and L. Rosasco, ‚ÄúGurls: a least squares library
for supervised learning,‚Äù CoRR, vol. abs/1303.0934, 2013.
[24] S. Voinea, C. Zhang, G. Evangelopoulos, L. Rosasco, and T. Poggio, ‚ÄúWord-level invariant
representations from acoustic waveforms,‚Äù vol. 14, pp. 3201‚Äì3205, September 2014.
[25] M. Benzeghiba, R. De Mori, O. Deroo, S. Dupont, T. Erbes, D. Jouvet, L. Fissore, P. Laface,
A. Mertins, C. Ris, R. Rose, V. Tyagi, and C. Wellekens, ‚ÄúAutomatic speech recognition and
speech variability: A review,‚Äù Speech Communication, vol. 49, pp. 763‚Äì786, 01 2007.

9

