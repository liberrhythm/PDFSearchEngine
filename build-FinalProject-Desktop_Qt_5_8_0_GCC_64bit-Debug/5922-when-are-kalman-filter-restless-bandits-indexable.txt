When are Kalman-Filter Restless Bandits Indexable?
Christopher Dance and Tomi Silander
Xerox Research Centre Europe
6 chemin de Maupertuis, Meylan, IseÌ€re, France
{dance,silander}@xrce.xerox.com

Abstract
We study the restless bandit associated with an extremely simple scalar Kalman
filter model in discrete time. Under certain assumptions, we prove that the problem is indexable in the sense that the Whittle index is a non-decreasing function of
the relevant belief state. In spite of the long history of this problem, this appears
to be the first such proof. We use results about Schur-convexity and mechanical
words, which are particular binary strings intimately related to palindromes.

1

Introduction

We study the problem of monitoring several time series so as to maintain a precise belief while minimising the cost of sensing. Such problems can be viewed as POMDPs with belief-dependent rewards [3] and their applications include active sensing [7], attention mechanisms for multiple-object
tracking [22], as well as online summarisation of massive data from time-series [4]. Specifically, we
discuss the restless bandit [24] associated with the discrete-time Kalman filter [19]. Restless bandits
generalise bandit problems [6, 8] to situations where the state of each arm (project, site or target)
continues to change even if the arm is not played. As with bandit problems, the states of the arms
evolve independently given the actions taken, suggesting that there might be efficient algorithms for
large-scale settings, based on calculating an index for each arm, which is a real number associated
with the (belief-)state of that arm alone. However, while bandits always have an optimal index policy (select the arm with the largest index), it is known that no index policy can be optimal for some
discrete-state restless bandits [17] and such problems are in general PSPACE-hard even to approximate to any non-trivial factor [10]. Further, in this paper we address restless bandits with real-valued
rather than discrete states. On the other hand, Whittle proposed a natural index policy for restless
bandits [24], but this policy only makes sense when the restless bandit is indexable (Section 2).
Briefly, a restless bandit is said to be indexable when an optimal solution to a relaxed version of the
problem consists in playing all arms whose indices exceed a given threshold. (The relaxed version
of the problem relaxes the constraint on the number of arms pulled per turn to a constraint on the
average number of arms pulled per turn). Under certain conditions, indexability implies a form of
asymptotic optimality of Whittleâ€™s policy for the original problem [23, 20].
Restless bandits associated with scalar Kalman(-Bucy) filters in continuous time were recently
shown to be indexable [12] and the corresponding discrete-time problem has attracted considerable
attention over a long period [15, 11, 16, 21]. However, that attention has produced no satisfactory
proof of indexability â€“ even for scalar time-series and even if we assume that there is a monotone
optimal policy for the single-arm problem, which is a policy that plays the arm if and only if the
relevant belief-state exceeds some threshold (here the relevant belief-state is a posterior variance).
Theorem 1 of this paper addresses that gap. After formalising the problem (Section 2), we describe the concepts and intuition (Section 3) behind the main result (Section 4). The main tools
are mechanical words (which are not sufficiently well-known) and Schur convexity. As these tools
are associated with rather general theorems, we believe that future work (Section 5) should enable
substantial generalisation of our results.
1

2

Problem and Index

We consider the problem of tracking N time-series, which we call arms, in discrete time. The state
Zi,t âˆˆ R of arm i at time t âˆˆ Z+ evolves as a standard-normal random walk independent of everything but its immediate past (Z+ , Râˆ’ and R+ all include zero). The action space is U := {1, . . . , N }.
Action ut = i makes an expensive observation Yi,t of arm i which is normally-distributed about Zi,t
with precision bi âˆˆ R+ and we receive cheap observations Yj,t of each other arm j with precision
aj âˆˆ R+ where aj < bj and aj = 0 means no observation at all.
Let Zt , Yt , Ht , Ft be the state, observation, history and observed history, so that Zt :=
(Z1,t , . . . , ZN,t ), Yt := (Y1,t , . . . , YN,t ), Ht := ((Z0 , u0 , Y0 ), . . . , (Zt , ut , Yt )) and Ft :=
((u0 , Y0 ), . . . , (ut , Yt )). Then we formalise the above as (1Â· is the indicator function)


1ut 6=i
1ut =i
Zi,0 âˆ¼ N (0, 1), Zi,t+1 | Ht âˆ¼ N (Zi,t , 1), Yi,t | Htâˆ’1 , Zt , ut âˆ¼ N Zi,t ,
+
.
ai
bi
Note that this setting is readily generalised to E[(Zi,t+1 âˆ’ Zi,t )2 ] 6= 1 by a change of variables.
Thus the posterior belief is given by the Kalman filter as Zi,t | Ft âˆ¼ N (ZÌ‚i,t , xi,t ) where the
posterior mean is ZÌ‚i,t âˆˆ R and the error variance xi,t âˆˆ R+ satisfies
x+1
x+1
and Ï†i,1 (x) :=
. (1)
xi,t+1 = Ï†i,1ut+1 =i (xi,t ) where Ï†i,0 (x) :=
ai x + ai + 1
bi x + bi + 1
Problem KF1. Let Ï€ be a policy so that ut = Ï€(Ftâˆ’1 ). Let xÏ€i,t be the error variance under Ï€. The
problem is to choose Ï€ so as to minimise the following objective for discount factor Î² âˆˆ [0, 1). The
objective consists of a weighted sum of error variances xÏ€i,t with weights wi âˆˆ R+ plus observation
costs hi âˆˆ R+ for i = 1, . . . , N :
"âˆž N
#
âˆž X
N
XX 
X
	

	
t
Ï€
E
Î² hi 1ut =i + wi xi,t =
Î² t hi 1ut =i + wi xÏ€i,t
t=0 i=1

t=0 i=1

where the equality follows as (1) is a deterministic mapping (and assuming Ï€ is deterministic).
Single-Arm Problem and Whittle Index. Now fix an arm i and write xÏ€t , Ï†0 (Â·), . . . instead of
xÏ€t,i , Ï†i,0 (Â·), . . . . Say there are now two actions ut = 0, 1 corresponding to cheap and expensive
observations respectively and the expensive observation now costs h + Î½ where Î½ âˆˆ R. The singlearm problem is to choose a policy, which here is an action sequence, Ï€ := (u0 , u1 , . . . )
âˆž
X
so as to minimise V Ï€ (x|Î½) :=
Î² t {(h + Î½)ut + wxÏ€t } where x0 = x.
(2)
t=0

Let Q(x, Î±|Î½) be the optimal cost-to-go in this problem if the first action must be Î± and let Ï€ âˆ— be an
optimal policy, so that
âˆ—

Q(x, Î±|Î½) := (h + Î½)Î± + wx + Î²V Ï€ (Ï†Î± (x)|Î½).
For any fixed x âˆˆ R+ , the value of Î½ for which actions u0 = 0 and u0 = 1 are both optimal is
known as the Whittle index Î»W (x) assuming it exists and is unique. In other words
The Whittle index Î»W (x) is the solution to Q(x, 0|Î»W (x)) = Q(x, 1|Î»W (x)).
(3)
Î±âˆ—
Let us consider a policy which takes action u0 = Î± then acts optimally producing actions ut (x)
and error variances xÎ±âˆ—
t (x). Then (3) gives
âˆž
âˆž
X 
	 X

	
0âˆ—
1âˆ—
Î² t (h + Î»W (x))u0âˆ—
+
wx
(x)
=
Î² t (h + Î»W (x))u1âˆ—
t
t
t + wxt (x) .
t=0

t=0

Solving this linear equation for the index Î»W (x) gives
Pâˆž t 0âˆ—
1âˆ—
W
t=1 Î² (xt (x) âˆ’ xt (x))
P
Î» (x) = w âˆž
âˆ’ h.
1âˆ—
0âˆ—
t
t=0 Î² (ut (x) âˆ’ ut (x))

(4)

Whittle [24] recognised that for his index policy (play the arm with the largest Î»W (x)) to make
sense, any arm which receives an expensive observation for added cost Î½, must also receive an
expensive observation for added cost Î½ 0 < Î½. Such problems are said to be indexable. The question
resolved by this paper is whether Problem KF1 is indexable. Equivalently, is Î»W (x) non-decreasing
in x âˆˆ R+ ?
2

x0*
t

x1*
t

A
I

? 0(x)

D

? 0(x)
x t+1

x t+1

G
B

J
E

? (x)

? (x)

1

H

1

C
F

xt

xt

1âˆ—
Figure 1: Orbit x0âˆ—
t (x) traces the path ABCDE . . . for the word 01w = 01101. Orbit xt (x) traces
the path F GHIJ . . . for the word 10w = 10101. Word w = 101 is a palindrome.

3

Main Result, Key Concepts and Intuition

We make the following intuitive assumption about threshold (monotone) policies.
A1. For some x âˆˆ R+ depending on Î½ âˆˆ R, the policy ut = 1xt â‰¥x is optimal for problem (2).
Note that under A1, definition (3) means the policy ut = 1xt >x is also optimal, so we can choose
ï£¼


0âˆ—
0 if x0âˆ—
Ï†0 (x0âˆ—
ï£´
0âˆ—
tâˆ’1 (x) â‰¤ x
tâˆ’1 (x)) if xtâˆ’1 (x) â‰¤ x
ï£´
u0âˆ—
(x)
:=
and
x
(x)
:=
ï£´
t
t
ï£½
1 otherwise
Ï†1 (x0âˆ—
(x))
otherwise
tâˆ’1
(5)


1âˆ—
ï£´
0 if x1âˆ—
Ï†0 (x1âˆ—
ï£´
1âˆ—
1âˆ—
tâˆ’1 (x) < x
tâˆ’1 (x)) if xtâˆ’1 (x) < x
ï£´
ut (x) :=
and xt (x) :=
ï£¾
1 otherwise
Ï†1 (x1âˆ—
tâˆ’1 (x)) otherwise
1âˆ—
0âˆ—
1âˆ—
where x0âˆ—
0 (x) = x0 (x) = x. We refer to xt (x), xt (x) as the x-threshold orbits (Figure 1).

We are now ready to state our main result.
Theorem 1. Suppose a threshold policy (A1) is optimal for the single-arm problem (2). Then
Problem KF1 is indexable. Specifically, for any b > a â‰¥ 0 let
x+1
x+1
Ï†0 (x) :=
,
Ï†1 (x) :=
ax + a + 1
bx + b + 1
and for any w âˆˆ R+ , h âˆˆ R and 0 < Î² < 1, let
Pâˆž t 0âˆ—
1âˆ—
W
t=1 Î² (xt (x) âˆ’ xt (x))
Î» (x) := w Pâˆž
âˆ’h
(6)
0âˆ—
t 1âˆ—
t=0 Î² (ut (x) âˆ’ ut (x))
1âˆ—
0âˆ—
1âˆ—
in which action sequences u0âˆ—
t (x), ut (x) and error variance sequences xt (x), xt (x) are given
W
in terms of Ï†0 , Ï†1 by (5). Then Î» (x) is a continuous and non-decreasing function of x âˆˆ R+ .

We are now ready to describe the key concepts underlying this result.
Words. In this paper, a word w is a string on {0, 1}âˆ— with k th letter wk and wi:j := wi wi+1 . . . wj .
The empty word is , the concatenation of words u, v is uv, the word that is the n-fold repetition
of w is wn , the infinite repetition of w is wÏ‰ and wÌƒ is the reverse of w, so w = wÌƒ means w is
a palindrome. The length of w is |w| and |w|u is the number of times that word u appears in w,
overlaps included.
Christoffel, Sturmian and Mechanical Words. It turns out that the action sequences in (5) are
given by such words, so the following definitions are central to this paper.
3

(0,1)
(0,01)

(01,1)

(0,001)
(0,0001)
(0,00001)

(00001,0001)

(001,01)

(0001,001)
(0001,0001001)

(001,00101)

(0001001,001)

(001,00100101)

(01,011)

(00101,01)

(00100101,00101)

(00101,0010101)

(01,01011)

(0010101,01)

(01,0101011)

(011,1)

(01011,011)

(0101011,01011) (01011,01011011)

(01011011,011)

(011,0111)
(011,0110111)

(0110111,0111)

(0111,1)
(0111,01111)

(01111,1)

Figure 2: Part of the Christoffel tree.
The Christoffel tree (Figure 2) is an infinite complete binary tree [5] in which each node is labelled
with a pair (u, v) of words. The root is (0, 1) and the children of (u, v) are (u, uv) and (uv, v).
The Christoffel words are the words 0, 1 and the concatenations uv for all (u, v) in that tree. The
fractions |uv|1 /|uv|0 form the Stern-Brocot tree [9] which contains each positive rational number
exactly once. Also, infinite paths in the Stern-Brocot tree converge to the positive irrational numbers.
Analogously, Sturmian words could be thought of as infinitely-long Christoffel words.
Alternatively, among many known characterisations, the Christoffel words can be defined as the
words 0, 1 and the words 0w1 where a := |0w1|1 /|0w1| and
(01w)n := b(n + 1)ac âˆ’ bnac
for any relatively prime natural numbers |0w1|0 and |0w1|1 and for n = 1, 2, . . . , |0w1|. The
Sturmian words are then the infinite words 0w1 w2 Â· Â· Â· where, for n = 1, 2, . . . and a âˆˆ (0, 1)\Q,
(01w1 w2 Â· Â· Â· )n := b(n + 1)ac âˆ’ bnac.
We use the notation 0w1 for Sturmian words although they are infinite.
The set of mechanical words is the union of the Christoffel and Sturmian words [13]. (Note that the
mechanical words are sometimes defined in terms of infinite repetitions of the Christoffel words.)
Majorisation. As in [14], let x, y âˆˆ Rm and let x(i) and y(i) be their elements sorted in ascending
order. We say x is weakly supermajorised by y and write x â‰ºw y if
j
X

x(k) â‰¥

k=1

j
X

y(k)

for all j = 1, . . . , m.

k=1

If this is an equality for j = m we say x is majorised by y and write x â‰º y. It turns out that
xâ‰ºy

â‡”

j
X
k=1

x[k] â‰¤

j
X

y[k]

for j = 1, . . . , m âˆ’ 1 with equality for j = m

k=1

where x[k] , y[k] are the sequences sorted in descending order. For x, y âˆˆ Rm we have [14]
xâ‰ºy

â‡”

m
X
i=1

f (xi ) â‰¤

m
X

f (yi ) for all convex functions f : R â†’ R.

i=1

More generally, a real-valued function Ï† defined on a subset A of Rm is said to be Schur-convex on
A if x â‰º y implies that Ï†(x) â‰¤ Ï†(y).
A11 x+A12
MoÌˆbius Transformations. Let ÂµA (x) denote the MoÌˆbius transformation ÂµA (x) := A
21 x+A22
where A âˆˆ R2Ã—2 . MoÌˆbius transformations such as Ï†0 (Â·), Ï†1 (Â·) are closed under composition, so
for any word w we define Ï†w (x) := Ï†w|w| â—¦ Â· Â· Â· â—¦ Ï†w2 â—¦ Ï†w1 (x) and Ï† (x) := x.

Intuition. Here is the intuition behind our main result.
For any x âˆˆ R+ , the orbits in (5) correspond to a particular mechanical word 0, 1 or 0w1 depending
on the value of x (Figure 1). Specifically, for any word u, let yu be the fixed point of the mapping Ï†u
on R+ so that Ï†u (yu ) = yu and yu âˆˆ R+ . Then the word corresponding to x is 1 for 0 â‰¤ x â‰¤ y1 ,
0w1 for x âˆˆ [y01w , y10w ] and 0 for y0 â‰¤ x < âˆž. In passing we note that these fixed points
are sorted in ascending order by the ratio Ï := |01w|0 /|01w|1 of counts of 0s to counts of 1s, as
4

100

y 01w and ?w(0)

80

60

40

20

0
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

|01w| 0 / |01w|1

Figure 3: Lower fixed points y01w of Christoffel words (black dots), majorisation points for those
words (black circles) and the tree of Ï†w (0) (blue).
illustrated by Figure 3. Interestingly, it turns out that ratio Ï is a piecewise-constant yet continuous
function of x, reminiscent of the Cantor function.
Also, composition of MoÌˆbius transformations is homeomorphic to matrix multiplication so that
for any A, B âˆˆ R2Ã—2 .

ÂµA â—¦ ÂµB (x) = ÂµAB (x)

Thus, the index (6) can be written in terms of the orbits of a linear system (11) given by 0, 1 or 0w1.
Further, if A âˆˆ R2Ã—2 and det(A) = 1 then the gradient of the corresponding MoÌˆbius transformation
is the convex function
1
dÂµA (x)
=
.
dx
(A21 x + A22 )2
So the gradient of the index is the difference of the sums of a convex function of the linear-system
orbits. However, such sums are Schur-convex functions and it follows that the index is increasing
because one orbit weakly supermajorises the other, as we now show for the case 0w1 (noting that
the proof is easier for words 0, 1). As 0w1 is a mechanical word, w is a palindrome. Further, if w is
a palindrome, it turns out that the difference between the linear-system orbits increases with x. So,
we might define the majorisation point for w as the x for which one orbit majorises the other. Quite
remarkably, if w is a palindrome then the majorisation point is Ï†w (0) (Proposition 7). Indeed the
black circles and blue dots of Figure 3 coincide. Finally, Ï†w (0) is less than or equal to y01w which
is the least x for which the orbits correspond to the word 0w1. Indeed, the blue dots of Figure 3 are
below the corresponding black dots. Thus one orbit does indeed supermajorise the other.

4
4.1

Proof of Main Result
Mechanical Words

The MoÌˆbius transformations of (1) satisfy the following assumption for I := R+ . We prove that the
fixed point yw of word w (the solution to Ï†w (x) = x on I) is unique in the supplementary material.
Assumption A2. Functions Ï†0 : I â†’ I, Ï†1 : I â†’ I, where I is an interval of R, are increasing
and non-expansive, so for all x, y âˆˆ I : x < y and for k âˆˆ {0, 1} we have
Ï†k (x) < Ï†k (y)
{z
}
|

Ï†k (y) âˆ’ Ï†k (x) < y âˆ’ x .
{z
}
|

and

increasing

non-expansive

Furthermore, the fixed points y0 , y1 of Ï†0 , Ï†1 on I satisfy y1 < y0 .
Hence the following two propositions (supplementary material) apply to Ï†0 , Ï†1 of (1) on I = R+ .
5

Proposition 1. Suppose A2 holds, x âˆˆ I and w is a non-empty word. Then
x < Ï†w (x) â‡” Ï†w (x) < yw â‡” x < yw

and

x > Ï†w (x) â‡” Ï†w (x) > yw â‡” x > yw .

1âˆ—
Ï‰
For a given x, in the notation of (5), we call the shortest word u such that (u1âˆ—
1 , u2 , . . . ) = u
the x-threshold word. Proposition 2 generalises a recent result about x-threshold words in a setting
where Ï†0 , Ï†1 are linear [18].
Proposition 2. Suppose A2 holds and 0w1 is a mechanical word. Then

0w1 is the x-threshold word â‡” x âˆˆ [y01w , y10w ].
Also, if x0 , x1 âˆˆ I with x0 â‰¥ y0 and x1 â‰¤ y1 then the x0 - and x1 -threshold words are 0 and 1.
We also use the following very interesting fact (Proposition 4.2 on p.28 of [5]).
Proposition 3. Suppose 0w1 is a mechanical word. Then w is a palindrome.
4.2

Properties of the Linear-System Orbits M (w) and Prefix Sums S(w)

Definition. Assume that a, b âˆˆ R+ and a < b. Consider the matrices





1
1
1
1
âˆ’1
F :=
,
G :=
and K :=
a 1+a
b 1+b
0


âˆ’1
1

so that the MoÌˆbius transformations ÂµF , ÂµG are the functions Ï†0 , Ï†1 of (1) and GF âˆ’F G = (bâˆ’a)K.
Given any word w âˆˆ {0, 1}âˆ— , we define the matrix product M (w)
M (w) := M (w|w| ) Â· Â· Â· M (w1 ),

where M () := I, M (0) := F and M (1) := G

where I âˆˆ R2Ã—2 is the identity and the prefix sum S(w) as the matrix polynomial
S(w) :=

|w|
X

M (w1:k ),

where S() := 0 (the all-zero matrix).

(7)

k=1

For any A âˆˆ R2Ã—2 , let tr(A) be the trace of A, let Aij = [A]ij be the entries of A and let A â‰¥ 0
indicate that all entries of A are non-negative.
Remark. Clearly, det(F ) = det(G) = 1 so that det(M (w)) = 1 for any word w. Also, S(w)
corresponds to the partial sums of the linear-system orbits, as hinted in the previous section.
The following proposition captures the role of palindromes (proof in the supplementary material).
Proposition 4. Suppose w is a word, p is a palindrome and n âˆˆ Z+ . Then
!
f h+1
f
1. M (p) = hh+f
for some f, h âˆˆ R,
2
âˆ’1
h
h+f
2. tr(M (10p)) = tr(M (01p)),
3. If u âˆˆ {p(10p)n , (10p)n 10} then M (u) âˆ’ M (uÌƒ) = Î»K for some Î» âˆˆ Râˆ’ ,
4. If w is a prefix of p then [M (p(10p)n 10w)]22 â‰¤ [M (p(01p)n 01w)]22 ,
5. [M ((10p)n 10w)]21 â‰¥ [M ((01p)n 01w)]21 ,
6. [M ((10p)n 1)]21 â‰¥ [M ((01p)n 0)]21 .
We now demonstrate a surprisingly simple relation between S(w) and M (w).
Proposition 5. Suppose w is a palindrome. Then
S21 (w) = M22 (w) âˆ’ 1

S22 (w) = M12 (w) + S21 (w).

and

(8)

Furthermore, if âˆ†k := [S(10w)M (w(10w)k ) âˆ’ S(01w)M (w(01w)k )]22 then
âˆ†k = 0

for all k âˆˆ Z+ .
6

(9)

Proof. Let us write M := M (w), S := S(w). We prove (8) by induction on |w|. In the base
case w âˆˆ {, 0, 1}. For w = , M22 âˆ’ 1 = 0 = S21 , M12 + S21 = 0 = S22 . For w âˆˆ {0, 1},
M22 âˆ’ 1 = c = S21 , M12 + S21 = 1 + c = S22 for some c âˆˆ {a, b}. For the inductive step, in
accordance with Claim 1 of Proposition 4, assume w âˆˆ {0v0, 1v1} for some word v satisfying
!


f h+1
f
c
d
h+f
M (v) = h2 âˆ’1
,
S(v) =
for some c, d, f, h âˆˆ R.
hâˆ’1 f +hâˆ’1
h
h+f
For w = 1v1, M := M (1v1) = GM (v)G and S := S(1v1) = GM (v)G+S(v)G+G. Calculating
the corresponding matrix products and sums gives
S21 = (bh + h + bf âˆ’ 1)(bh + 2h + bf + f + 1)(h + f )âˆ’1 = M22 âˆ’ 1
S22 âˆ’ S21 = bh + 2h + bf + f = M12
as claimed. For w = 0u0 the claim also holds as F = G|b=a . This completes the proof of (8).
Furthermore Part. Let A := S(w)F G + F G + G and B := S(w)GF + GF + F . Then
âˆ†k = [(A(M (w)F G)k âˆ’ B(M (w)GF )k )M (w)]22
(10)
by definition of S(Â·). By Claim 1 of Proposition 4 and (8) we know that
!


f h+1
f
c
d
h+f
M (w) = h2 âˆ’1
,
S(w) =
for some c, d, f, h âˆˆ R.
hâˆ’1 f +hâˆ’1
h
h+f
Substituting these expressions and the definitions of F, G into the definitions of A, B and then
into (10) for k âˆˆ {0, 1} directly gives âˆ†0 = âˆ†1 = 0 (although this calculation is long).
Now consider the case k â‰¥ 2. Claim 2 of Proposition 4 says tr(M (10w)) = tr(M (01w)) and clearly
det(M (10w)) = det(M (01w)) = 1. Thus we can diagonalise as
M (w)F G =: U DU âˆ’1 ,

D := diag(Î», 1/Î») for some Î» â‰¥ 1

so that âˆ†k = [AU D U M (w) âˆ’ e BV D V M (w)]22 =: Î³1 Î»k + Î³2 Î»âˆ’k . So, if Î» = 1 then
âˆ†k = Î³1 + Î³2 = âˆ†0 and we already showed that âˆ†0 = 0. Otherwise Î» 6= 1, so âˆ†0 = âˆ†1 = 0
implies Î³1 + Î³2 = Î³1 Î» + Î³2 Î»âˆ’1 = 0 which gives Î³1 = Î³2 = 0. Thus for any k âˆˆ Z+ we have
âˆ†k = Î³1 Î»k + Î³2 Î»âˆ’k = 0.
k

4.3

âˆ’1

M (w)GF =: V DV âˆ’1 ,
T

k

âˆ’1

Majorisation

The following is a straightforward consequence of results in [14] proved in the supplementary material. We emphasize that the notation â‰ºw has nothing to do with the notion of w as a word.
a symmetric function that is convex and
Proposition 6. Suppose x, y âˆˆ Rm
+ and f : R â†’ R is
Pm i
Pm i
decreasing on R+ . Then x â‰ºw y and Î² âˆˆ [0, 1] â‡’
i=1 Î² f (x(i) ) â‰¥
i=1 Î² f (y(i) ).
For any x âˆˆ R and any fixed word w, define the sequences for n âˆˆ Z+ and k = 1, . . . , m
)
xnm+k (x) := [M ((10w)n (10w)1:k )v(x)]2 , Ïƒx(n) := (xnm+1 (x), . . . , xnm+m (x))
ynm+k (x) := [M ((01w)n (01w)1:k )v(x)]2 ,

Ïƒy(n) := (ynm+1 (x), . . . , ynm+m (x))

(11)

where m := |10w| and v(x) := (x, 1)T .
(n)

Proposition 7. Suppose w is a palindrome and x â‰¥ Ï†w (0). Then Ïƒx
(n)
(n)
sequences on R+ and Ïƒx â‰ºw Ïƒy for any n âˆˆ Z+ .

(n)

and Ïƒy

are ascending

Proof. Clearly Ï†w (0) â‰¥ 0 so x â‰¥ 0 and hence v(x) â‰¥ 0. So for any word u and letter c âˆˆ {0, 1} we
have M (uc)v(x) = M (c)M (u)v(x) â‰¥ M (u)v(x) â‰¥ 0 as M (c) â‰¥ I. Thus xk+1 (x) â‰¥ xk (x) â‰¥ 0
(n)
(n)
and yk+1 (x) â‰¥ yk (x) â‰¥ 0. In conclusion, Ïƒx and Ïƒy are ascending sequences on R+ .
Now Ï†w (0) =

[M (w)]12
[M (w)]22 .

Thus [Av(Ï†w (0))]2 :=

[AM (w)]22
[M (w)]22

for any A âˆˆ R2Ã—2 . So

xnm+k (Ï†w (0)) âˆ’ ynm+k (Ï†w (0))
1
=
[(M ((10w)n (10w)1:k ) âˆ’ M ((01w)n (01w)1:k ))M (w)]22 â‰¤ 0
[M (w)]22
7

for k = 2, . . . , m by Claim 4 of Proposition 4. So all but the first term of the sum Tm (Ï†w (0)) is
non-positive where
Tj (x) :=

j
X

(xnm+k (x) âˆ’ ynm+k (x)).

k=1

Thus T1 (Ï†w (0)) â‰¥ T2 (Ï†w (0)) â‰¥ . . . Tm (Ï†w (0)). But
m
X
1
Tm (Ï†w (0)) =
[(M ((10w)n (10w)1:k ) âˆ’ M ((01w)n (01w)1:k ))M (w)]22
[M (w)]22
k=1

1
[S(10w)M (w(10w)n ) âˆ’ S(01w)M (w(01w)n )]22 = 0
=
[M (w)]22
where the last step follows from (9). So Tj (Ï†w (0)) â‰¥ 0 for j = 1, . . . , m. Yet Claims 5 and 6 of
Pj
d
Tj (x) = k=1 [M ((10w)n (10w)1:k ) âˆ’ M ((01w)n (01w)1:k )]21 â‰¥ 0. So for
Proposition 4 give dx
(n)
(n)
x â‰¥ Ï†w (0) we have Tj (x) â‰¥ 0 for j = 1, . . . , m which means that Ïƒx â‰ºw Ïƒy .
4.4

Indexability

Theorem 1. The index Î»W (x) of (6) is continuous and non-decreasing for x âˆˆ R+ .
Proof. As weight w is non-negative and cost h is a constant we only need to prove the result for
Î»(x) := Î»W (x)w=1,h=0 and we can use w to denote a word. By Proposition 2, x âˆˆ [y01w , y10w ]
for some mechanical word 0w1. (Cases x âˆˆ
/ (y1 , y0 ) are clarified in the supplementary material.)
Let us show that the hypotheses of Proposition 7 are satisfied by w and x. Firstly, w is a palindrome
by Proposition 3. Secondly, Ï†w01 (0) â‰¥ 0 and as Ï†w (Â·) is monotonically increasing, it follows that
Ï†w â—¦Ï†w01 (0) â‰¥ Ï†w (0). Equivalently, Ï†01w â—¦Ï†w (0) â‰¥ Ï†w (0) so that Ï†w (0) â‰¤ y01w by Proposition 1.
Hence x â‰¥ y01w â‰¥ Ï†w (0).
(n)

(n)

Thus Proposition 7 applies, showing that the sequences Ïƒx and Ïƒy , with elements xnm+k (x) and
(n)
(n)
ynm+k (x) as defined in (11), are non-decreasing sequences on R+ with Ïƒx â‰ºw Ïƒy . Also, 1/x2
is a symmetric function that is convex and decreasing on R+ . Therefore Proposition 6 applies giving

m 
X
Î² nm+kâˆ’1
Î² nm+kâˆ’1
âˆ’
â‰¥0
for any n âˆˆ Z+ where m := |01w|.
(12)
(xnm+k (x))2
(ynm+k (x))2
k=1

Also Proposition 2 shows that the x-threshold orbits are (Ï†u1 (x), . . . , Ï†u1:k (x), . . . ) and
(Ï†l1 (x), . . . , Ï†l1:k (x), . . . ) where u := (01w)Ï‰ and l := (10w)Ï‰ . So the denominator of (6) is
âˆž
âˆž
âˆž
X
X
1 âˆ’ Î² m X kâˆ’1
Î² k (1lk+1 =1 âˆ’ 1uk+1 =1 ) =
Î² mk (1 âˆ’ Î²) â‡’ Î»(x) =
Î²
(Ï†u1:k (x) âˆ’ Ï†l1:k (x)).
1âˆ’Î²
k=0

k=0

Note that

d ex+f
dx gx+h

k=1

1
(gx+h)2

for any eh âˆ’ f g = 1. Then (12) gives

âˆž m 
dÎ»(x)
1 âˆ’ Î²m X X
Î² nm+kâˆ’1
Î² nm+kâˆ’1
=
âˆ’
â‰¥ 0.
dx
1 âˆ’ Î² n=0
(xnm+k (x))2
(ynm+k (x))2
=

k=1

But Î»(x) is continuous for x âˆˆ R+ (as shown in the supplementary material). Therefore we conclude that Î»(x) is non-decreasing for x âˆˆ R+ .

5

Further Work

One might attempt to prove that assumption A1 holds using general results about monotone optimal
policies for two-action MDPs based on submodularity [2] or multimodularity [1]. However, we find
counter-examples to the required submodularity condition. Rather, we are optimistic that the ideas
of this paper themselves offer an alternative approach to proving A1. It would then be natural to
extend our results to settings where the underlying state evolves as Zt+1 | Ht âˆ¼ N (mZt , 1) for
some multiplier m 6= 1 and to cost functions other than the variance. Finally, the question of the
indexability of the discrete-time Kalman filter in multiple dimensions remains open.
8

References
[1] E. Altman, B. Gaujal, and A. Hordijk. Multimodularity, convexity, and optimization properties. Mathematics of Operations Research, 25(2):324â€“347, 2000.
[2] E. Altman and S. Stidham Jr. Optimality of monotonic policies for two-action Markovian decision processes, with applications to control of queues with delayed information. Queueing Systems, 21(3-4):267â€“
291, 1995.
[3] M. Araya, O. Buffet, V. Thomas, and F. Charpillet. A POMDP extension with belief-dependent rewards.
In Neural Information Processing Systems, pages 64â€“72, 2010.
[4] A. Badanidiyuru, B. Mirzasoleiman, A. Karbasi, and A. Krause. Streaming submodular maximization:
Massive data summarization on the fly. In Proceedings of the 20th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pages 671â€“680, 2014.
[5] J. Berstel, A. Lauve, C. Reutenauer, and F. Saliola. Combinatorics on Words: Christoffel Words and
Repetitions in Words. CRM Monograph Series, 2008.
[6] S. Bubeck and N. Cesa-Bianchi. Regret Analysis of Stochastic and Nonstochastic Multi-armed Bandit
Problems, Foundation and Trends in Machine Learning, Vol. 5. NOW, 2012.
[7] Y. Chen, H. Shioi, C. Montesinos, L. P. Koh, S. Wich, and A. Krause. Active detection via adaptive
submodularity. In Proceedings of The 31st International Conference on Machine Learning, pages 55â€“63,
2014.
[8] J. Gittins, K. Glazebrook, and R. Weber. Multi-armed bandit allocation indices. John Wiley & Sons,
2011.
[9] R. Graham, D. Knuth, and O. Patashnik. Concrete Mathematics: A Foundation for Computer Science.
Addison-Wesley, 1994.
[10] S. Guha, K. Munagala, and P. Shi. Approximation algorithms for restless bandit problems. Journal of the
ACM, 58(1):3, 2010.
[11] B. La Scala and B. Moran. Optimal target tracking with restless bandits. Digital Signal Processing,
16(5):479â€“487, 2006.
[12] J. Le Ny, E. Feron, and M. Dahleh. Scheduling continuous-time Kalman filters. IEEE Trans. Automatic
Control, 56(6):1381â€“1394, 2011.
[13] M. Lothaire. Algebraic combinatorics on words. Cambridge University Press, 2002.
[14] A. Marshall, I. Olkin, and B. Arnold. Inequalities: Theory of majorization and its applications. Springer
Science & Business Media, 2010.
[15] L. Meier, J. Peschon, and R. Dressler. Optimal control of measurement subsystems. IEEE Trans. Automatic Control, 12(5):528â€“536, 1967.
[16] J. NinÌƒo-Mora and S. Villar. Multitarget tracking via restless bandit marginal productivity indices and
Kalman filter in discrete time. In Proceedings of the 48th IEEE Conference on Decision and Control,
pages 2905â€“2910, 2009.
[17] R. Ortner, D. Ryabko, P. Auer, and R. Munos. Regret bounds for restless Markov bandits. In Algorithmic
Learning Theory, pages 214â€“228. Springer, 2012.
[18] B. Rajpathak, H. Pillai, and S. Bandyopadhyay. Analysis of stable periodic orbits in the one dimensional
linear piecewise-smooth discontinuous map. Chaos, 22(3):033126, 2012.
[19] T. Thiele. Sur la compensation de quelques erreurs quasi-systeÌmatiques par la meÌthode des moindres
carreÌs. CA Reitzel, 1880.
[20] I. Verloop. Asymptotic optimal control of multi-class restless bandits. CNRS Technical Report, hal00743781, 2014.
[21] S. Villar. Restless bandit index policies for dynamic sensor scheduling optimization. PhD thesis, Statistics
Department, Universidad Carlos III de Madrid, 2012.
[22] E. Vul, G. Alvarez, J. B. Tenenbaum, and M. J. Black. Explaining human multiple object tracking as
resource-constrained approximate inference in a dynamic probabilistic model. In Neural Information
Processing Systems, pages 1955â€“1963, 2009.
[23] R. R. Weber and G. Weiss. On an index policy for restless bandits. Journal of Applied Probability, pages
637â€“648, 1990.
[24] P. Whittle. Restless bandits: Activity allocation in a changing world. Journal of Applied Probability,
pages 287â€“298, 1988.

9

